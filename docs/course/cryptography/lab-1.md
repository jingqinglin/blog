?> Many Time Pad

## å®éªŒå†…å®¹

> ã€æ—¶é—´ã€‘ 5 æœˆ 23 å·ï¼ˆå‘¨å…­ï¼‰æ™šä¸Š
> 
> ã€ç¼–ç¨‹è¯­è¨€ã€‘ Pythonï¼ˆæ¨èï¼‰æˆ–è€… C/C++
> 
> ã€å®éªŒç›®çš„ã€‘
> 
> 1. äº†è§£æµå¯†ç çš„ç»“æ„ç‰¹ç‚¹ï¼›
> 2. æŒæ¡ One-time Pad çš„ä¸€èˆ¬å…·ä½“å®ç°ï¼›
> 3. é€šè¿‡ä½¿ç”¨ Pythonï¼ˆæ¨èï¼‰æˆ–è€… Cï¼Œç¼–ç¨‹å®ç°ä¸€ä¸ªæµå¯†ç åŠ å¯†ç¤ºä¾‹çš„ç ´è§£ï¼Œè¿›ä¸€æ­¥è®¤è¯†åœ¨æµå¯†ç åŠ å¯†ä¸­å¤šæ¬¡ä½¿ç”¨ç›¸åŒå¯†é’¥å¯¼è‡´çš„é—®é¢˜ã€‚
> 
> ã€å®éªŒå†…å®¹ã€‘
> 
> åœ¨æŒæ¡æµå¯†ç ç»“æ„çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡æœ¬å®éªŒè§‚å¯Ÿä½¿ç”¨ç›¸åŒæµå¯†ç å¯†é’¥åŠ å¯†å¤šä¸ªæ˜æ–‡å¯¼è‡´çš„ä¸¥é‡åæœã€‚
> 
> é™„ä»¶ [ciphertext.txt](course/cryptography/lab-1-ciphertext.txt ':ignore') æœ‰ 11 ä¸ªåå…­è¿›åˆ¶ç¼–ç çš„å¯†æ–‡ï¼Œå®ƒä»¬æ˜¯ä½¿ç”¨æµå¯†ç åŠ å¯† 11 ä¸ªæ˜æ–‡çš„ç»“æœï¼Œæ‰€æœ‰å¯†æ–‡éƒ½ä½¿ç”¨ç›¸åŒçš„æµå¯†ç å¯†é’¥ã€‚
> 
> å®éªŒçš„ç›®æ ‡æ˜¯è§£å¯†æœ€åä¸€ä¸ªå¯†æ–‡ï¼Œå¹¶æäº¤æ˜æ–‡æ¶ˆæ¯ã€‚
> 
>   
> æç¤ºï¼š
> 
> 1. å¯¹å¯†æ–‡è¿›è¡Œå¼‚æˆ–ï¼Œå¹¶è€ƒè™‘å½“ç©ºæ ¼ä¸ [a ~ z, A ~ Z] ä¸­çš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚
> 2. é™„ä»¶ [encrypt.py](course/cryptography/lab-1-encrypt.py ':ignore') æ˜¯ç”¨äºç”Ÿæˆå¯†æ–‡çš„ Python ç¤ºä¾‹ç¨‹åºï¼ˆä¸å½±å“å®éªŒï¼Œä»…ä¾›å‚è€ƒï¼‰ã€‚ 

## å®éªŒåˆ†æ

é¦–å…ˆä»ç”Ÿæˆå¯†æ–‡çš„ç¤ºä¾‹ç¨‹åº [encrypt.py](course/cryptography/lab-1-encrypt.py ':ignore') å…¥æ‰‹ï¼š

```python
def strxor(a, b):
    # xor two strings of different lengths
    if len(a) > len(b):
        return "".join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a[:len(b)], b)])
    else:
        return "".join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b[:len(a)])])
```

å…¶ä¸­ `strxor(a, b)` ä¸ºåŠ å¯†å‡½æ•°ï¼Œå‚æ•° `a` ä¸ºå¯†é’¥ï¼Œ`b` ä¸ºæ˜æ–‡ã€‚æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåŠ å¯†å°±æ˜¯å¯¹æ˜æ–‡å’Œå¯†é’¥è¿›è¡Œ**å¼‚æˆ–**ã€‚ä»å¼‚æˆ–å…¥æ‰‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºä¸€äº›çº¿ç´¢ã€‚

### çº¿ç´¢ 1

ä»æç¤ºä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°â€œçº¿ç´¢â€ï¼šå­—æ¯å¼‚æˆ–ç©ºæ ¼ï¼Œç›¸å½“äºè½¬æ¢å¤§å°å†™ã€‚
- `ç©ºæ ¼ ^ å°å†™å­—æ¯ = å¤§å†™å­—æ¯`ï¼Œæ¯”å¦‚ `'a' ^ ' ' = 'A'`
- `ç©ºæ ¼ ^ å¤§å†™å­—æ¯ = å°å†™å­—æ¯`
- `å­—æ¯ ^ å­—æ¯ = éå­—æ¯`


å› æ­¤ï¼Œå¯¹äºæ¶ˆæ¯ $m$ï¼Œå¯¹ä½ç½® $i$ï¼Œ$j$ ä¸Šçš„å­—ç¬¦ $m_i$, $m_j$ è¿›è¡Œå¼‚æˆ–ï¼Œå¦‚æœå¼‚æˆ–ç»“æœä¸ºè‹±æ–‡å­—æ¯ï¼Œé‚£ä¹ˆ $i$ï¼Œ$j$ ä¸¤ä¸ªä½ç½®ä¸Šçš„å­—ç¬¦**å¾ˆå¯èƒ½**ä¸€ä¸ªæ˜¯ç©ºæ ¼ï¼Œå¦ä¸€ä¸ªæ˜¯è‹±æ–‡å­—æ¯ï¼ˆä½†ä¹Ÿæœ‰å…¶ä»–å¯èƒ½ï¼Œæ¯”å¦‚ `'!' ^ 'B' = 'c'`ï¼Œå®éªŒæœ€åè¿›è¡Œäº†è§£é‡Šï¼‰ã€‚

### çº¿ç´¢ 2

å¯¹äºå¼‚æˆ–ï¼Œæˆ‘ä»¬æœ‰å¦å¤–ä¸€ä¸ªæ€§è´¨ï¼š$x = x \oplus y \oplus y$ã€‚

å‡è®¾å¯†æ–‡ $c$ã€æ¶ˆæ¯ $m$ã€å¯†é’¥ $k$ï¼Œæœ‰ $c_1 = m_1 \oplus k$ï¼Œ$c_2 = m_2 \oplus k$ â€¦â€¦ã€‚äºæ˜¯æ ¹æ®ä¸Šè¿°å¼‚æˆ–çš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° $c_1 \oplus c_2 = m_1 \oplus k \oplus m_2 \oplus k = m_1 \oplus m_2$ï¼Œæ­¤æ—¶ï¼Œ$k$ è¢«æ¶ˆå»äº†ï¼Œå¾—åˆ°äº†ç­‰å¼ $c_1 \oplus c_2 = m_1 \oplus m_2$ã€‚

### æ€è·¯

æ ¹æ®â€œçº¿ç´¢â€ï¼Œæˆ‘ä»¬å¯ä»¥å½¢æˆå¤§è‡´çš„è§£å¯†æ€è·¯ï¼š

å…ˆå¯»æ‰¾æ˜æ–‡ä¸­å¯èƒ½å­˜åœ¨çš„ç©ºæ ¼ï¼Œä½ç½®è®°ä¸º $p$ï¼Œæ¥ç€æœ‰ä¸¤ç§æ€è·¯ï¼Œ
- ä¸€ç§æ–¹æ³•æ˜¯ï¼šå°† $p$ å¯¹åº”çš„å¯†æ–‡ï¼ˆ$c$ï¼‰å’Œ space åšå¼‚æˆ–æ“ä½œï¼Œå°±å¯å¾—åˆ°å¯¹åº”ä½ç½®çš„å¯†é’¥ä¿¡æ¯ï¼Œå½“è·å–è¶³å¤Ÿå¤šçš„å¯†é’¥ä¿¡æ¯åï¼Œå³å¯å¯¹ç›®æ ‡å¯†æ–‡è¿›è¡Œè§£å¯†
  - è§£é‡Šï¼šå› ä¸ºæ­¤æ—¶ä½ç½® $p$ çš„æ˜æ–‡ä¸ºç©ºæ ¼ï¼Œå³ $m = space$ï¼Œæ‰€ä»¥æœ‰ $c \oplus space = m \oplus k \oplus space = space \oplus k \oplus space = k$
- å¦ä¸€ç§æ–¹æ³•æ˜¯ï¼šå°† $p$ å¯¹åº”çš„å¯†æ–‡ï¼ˆ$c_1$ï¼‰ç›´æ¥å’Œå¾…è§£å¯†å¯†æ–‡ï¼ˆ$c_2$ï¼‰è¿›è¡Œå¼‚æˆ–ï¼Œå¯å¾—å‡ºå¾…è§£å¯†å¯†æ–‡å¯¹åº”ä½ç½®ä¸Šçš„æ˜æ–‡ï¼ˆå¤§å°å†™ç›¸åï¼‰
  - è§£é‡Šï¼š$c_1 \oplus c_2 = m_1 \oplus m_2$ï¼Œå› ä¸º $m_1$ ä¸ºç©ºæ ¼ï¼Œæ‰€ä»¥ $c_1 \oplus c_2$ çš„ç»“æœä¸º $m_2$ è½¬æ¢å¤§å°å†™çš„ç»“æœ

å¦‚ä½•å¯»æ‰¾æ˜æ–‡ä¸­å¯èƒ½å­˜åœ¨çš„ç©ºæ ¼å‘¢ï¼Ÿ

åœ¨ [ciphertext.txt](course/cryptography/lab-1-ciphertext.txt ':ignore') ä¸­ï¼Œæ¯ä¸¤ä¸ª 16 è¿›åˆ¶å­—ç¬¦ä»£è¡¨æ˜æ–‡çš„ä¸€ä¸ªå­—ç¬¦ï¼ˆå› ä¸º ASCII çš„èŒƒå›´ä¸º 0 ~ 255ï¼‰ã€‚æˆ‘ä»¬æŠŠæŸæ¡å¯†æ–‡ä¸å‰©ä½™ 9 æ¡å¯†æ–‡çš„ç›¸åŒä½ç½®è¿›è¡Œå¼‚æˆ–ï¼Œå¦‚æœå¼‚æˆ–å‡ºæ¥ç»“æœå¤§éƒ¨åˆ†éƒ½æ˜¯å­—æ¯ï¼Œåˆ™è¯´æ˜äº†è¿™æ¡å¯†æ–‡çš„è¿™ä¸ªä½ç½®å¯¹åº”çš„æ˜æ–‡**ææœ‰å¯èƒ½**æ˜¯ä¸ªç©ºæ ¼ã€‚

å› æ­¤ï¼Œä»ä¸Šè¿°åˆ†æå¾—çŸ¥ï¼Œåœ¨æµå¯†ç åŠ å¯†ä¸­å¤šæ¬¡ä½¿ç”¨ç›¸åŒå¯†é’¥æ˜¯ä¸å®‰å…¨çš„ã€‚

## ä»£ç 
ä»¥ä¸‹ä»£ç ç‰‡æ®µé€šè¿‡è®¡ç®—å‡ºå¯†é’¥çš„æ–¹æ³•ï¼ˆè€Œéç›´æ¥å¯¹ç›®æ ‡å¯†æ–‡è¿›è¡Œå¼‚æˆ–ï¼‰æ¥è§£å¯†ï¼Œå¹¶å¯¹å…³é”®éƒ¨åˆ†è¿›è¡Œæ³¨é‡Šã€‚

> [!TIP]
> è®¡ç®—ç©ºæ ¼çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠå¾…è§£å¯†å¯†æ–‡ä¹Ÿä¸€èµ·æ”¾è¿›å»å¼‚æˆ–ï¼Œå¢åŠ æ ·æœ¬

ä»£ç  ğŸ‘‰ [ä¼ é€é—¨](course/cryptography/lab-1-solution ':target=_blank')

## å®éªŒç»“æœ
è¿è¡Œä¸Šè¿°ä»£ç ï¼Œè¾“å‡ºï¼š
`The secuet message is: Whtn using aastream cipher, never use the key more than once`

å¯ä»¥çŒœå‡ºï¼ŒåŸæ–‡ä¸ºï¼š`The secret message is: When using a stream cipher, never use the key more than once`

<br>

> [!NOTE]
> æˆ‘ä»¬å‘ç°ï¼Œç¬¬ 8 ä¸ªå­—ç¬¦ `r`ï¼ˆ`secret`ï¼‰è¢«è§£ææˆäº† `u`ã€‚
>
> ![](_images/lab-1-1.png ':class=resizedImage')
>
> ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰ç¬¬ 5 æ¡å¯†æ–‡çš„ç¬¬ 8 ä¸ªä½ç½®è¢«**å‡å®š**ä¸ºç©ºæ ¼ï¼Œä½†æ˜¯æœ€ç»ˆç¬¬ 8 ä¸ªå­—ç¬¦å´è§£é”™äº†ï¼Œç”±æ­¤è¯´æ˜ç¬¬ 5 æ¡å¯†æ–‡çš„ç¬¬ 8 ä¸ªä½ç½®å®é™…ä¸Šå¹¶ä¸æ˜¯ç©ºæ ¼ï¼Œå®ƒè¢«è¯¯åˆ¤äº†ã€‚é‚£è¿™ä¸ªä½ç½®çš„æ­£ç¡®æ˜æ–‡æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ[è¿™ç¯‡æ–‡ç« ](https://blog.csdn.net/liuweiran900217/article/details/19933549)ç»™å‡ºäº†æ­£ç¡®ç‡è¾ƒé«˜çš„æ˜æ–‡ï¼Œä¸‹å›¾ï¼š
>
> ![](_images/lab-1-2.png ':class=resizedImage')
>
> å¯ä»¥çœ‹åˆ°è¯¥ä½ç½®æ˜¯ä¸€ä¸ªå•å¼•å· `'`ï¼ŒæŠŠå•å¼•å·å’Œæ‰€æœ‰å­—æ¯è¿›è¡Œå¼‚æˆ–ï¼š
>
> ![](_images/lab-1-3.png ':class=resizedImage')
>
> å¤§å¤šæ•°éƒ½æ˜¯å­—æ¯ï¼Œæ‰€ä»¥å•å¼•å·è¢«è¯¯åˆ¤äº†ï¼ˆå› ä¸ºåˆ¤æ–­ç©ºæ ¼çš„ä¾æ®æ˜¯å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯å¦ä¸ºå­—æ¯ï¼‰ã€‚